(()=>{"use strict";var e={1020:(e,t,r)=>{var s=r(1609),a=Symbol.for("react.element"),o=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,l=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function i(e,t,r){var s,o={},i=null,p=null;for(s in void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(p=t.ref),t)n.call(t,s)&&!c.hasOwnProperty(s)&&(o[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===o[s]&&(o[s]=t[s]);return{$$typeof:a,type:e,key:i,ref:p,props:o,_owner:l.current}}t.Fragment=o,t.jsx=i,t.jsxs=i},1609:e=>{e.exports=window.React},4848:(e,t,r)=>{e.exports=r(1020)}},t={};const r=window.wp.data,s="stellarpay/woocommerce-product-edit-page",a=window.wp.i18n,o={onetimePayments:{id:"onetimePayments",label:(0,a.__)("One-time Payment","stellarpay"),description:(0,a.__)("Charge a one-time payment","stellarpay")},subscriptionPayments:{id:"subscriptionPayments",label:(0,a.__)("Subscription Payment","stellarpay"),description:(0,a.__)("Charge a recurring payment","stellarpay")},installmentPayments:{id:"installmentPayments",label:(0,a.__)("Installment Payment","stellarpay"),description:(0,a.__)("Charge a number of payments","stellarpay")}},n=window.wp.htmlEntities;function l(e){const t=document.querySelectorAll("#variable_product_options .woocommerce_variation.wc-metabox");t.length&&t.forEach((t=>{[t.querySelector('p[class*="variable_regular_price"]'),t.querySelector('p[class*="variable_sale_price"]'),t.querySelector('div[class*="sale_price_dates_fields"]')].forEach((t=>{t&&t.classList[e]("sp-absolute","-sp-left-full")}))}))}function c(){const e=document.querySelector("#variable_product_options .woocommerce_variations");return!!e&&parseInt(e?.getAttribute("data-total"),10)>0}function i(){const e=document.querySelector('.woocommerce_variations .stellarpay-data input[name="stellarpay[productType]"]');e.parentElement.classList.add("variation-needs-update"),jQuery(e).trigger("change")}const{settings:p,woocommerce:{currencySymbol:d}}=stellarPayProductEditPage,{currency:{decimalSeparator:u}}=wcSettings,m=document.getElementById("product-type"),y={amount:"",billingPeriod:"",recurringFrequency:0,recurringPeriod:""},g={options:{subscriptionPayments:y,installmentPayments:{...y,numberOfPayments:0},...p,wooProductType:m.value,hasVariations:c()},config:{currencySymbol:d,decodedCurrencySymbol:(0,n.decodeEntities)(d),decimalSeparator:u,errorMessages:{invalidAmount:woocommerce_admin.i18n_mon_decimal_error,saleAmountLessThanRegularAmount:woocommerce_admin.i18n_sale_less_than_regular_error}}},_={getOptions:e=>e.options,getOption:(e,t)=>e.options[t],getSubscriptionPaymentOptions:e=>e.options[o.subscriptionPayments.id],getInstallmentPaymentOptions:e=>e.options[o.installmentPayments.id],getConfig:e=>e.config,getProductType:e=>e.options.productType,getWooProductType:e=>e.options.wooProductType},f=(0,r.createReduxStore)(s,{reducer:(e=g,t)=>{switch(t.type){case"SET_OPTIONS":case"SET_OPTION":const r={...e.options,...t.options};return{...e,options:r};case"RESET_OPTIONS":return{...e,options:{...g.options}}}return e},actions:{setOptions:e=>({type:"SET_OPTIONS",options:e}),setOption:(e,t)=>({type:"SET_OPTION",options:{[t]:e}}),resetOptions:()=>({type:"RESET_OPTIONS"}),setProductType:e=>({type:"SET_OPTION",options:{productType:e}}),setWooProductType:e=>({type:"SET_OPTION",options:{wooProductType:e}})},selectors:_});(0,r.register)(f);var v=function r(s){var a=t[s];if(void 0!==a)return a.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,r),o.exports}(4848);const b=window.wp.element,h=new Map;function x(e,t){const r=`${e}:stellarpay-app-container`;!function(e){if(h.has(e))try{return h.get(e).unmount(),h.delete(e),!0}catch(e){console.error("Error unmounting React root:",e)}}(r);const s=document.getElementById(e);if(!s)return void console.error(`Container with id "${e}" not found.`);const a=s.querySelector(".stellarpay-app-container");a&&a.remove();const o=document.createElement("div");o.style.display="none",o.classList.add("stellarpay-app-container"),s.prepend(o);try{const e=(0,b.createRoot)(o);e.render(t),h.set(r,e)}catch(e){console.error("Error creating React root:",e)}}const w=window.wp.compose,j="simple",P="variable";function S(e){var t,r,s="";if("string"==typeof e||"number"==typeof e)s+=e;else if("object"==typeof e)if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=S(e[t]))&&(s&&(s+=" "),s+=r)}else for(r in e)e[r]&&(s&&(s+=" "),s+=r);return s}const T=function(){for(var e,t,r=0,s="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=S(e))&&(s&&(s+=" "),s+=t);return s},E=(0,w.compose)([(0,r.withSelect)((e=>{const{getProductType:t}=e(s);return{productType:t()}})),(0,r.withDispatch)((e=>{const{setProductType:t}=e(s);return{setProductType:t}}))])((e=>{const{productType:t,setProductType:r}=e,s=Object.keys(o);return(0,v.jsx)("div",{className:"sp-flex sp-ml-2",children:s.map(((e,a)=>{const{label:n,description:l}=o[e],c=t===e,i=0===a,p=s.length===a+1,d=T({"sp-border sp-border-solid sp-py-4 sp-px-6 sp-cursor-pointer sp-text-left":!0,"sp-border-gray-300 sp-bg-white sp-text-slate-700":!c,"sp-border-gray-900 sp-bg-gray-900 sp-text-white":c,"sp-border-r-0":!p,"sp-rounded-l":i,"sp-rounded-r":p});return(0,v.jsxs)("button",{className:d,onClick:t=>((e,t)=>{e.preventDefault(),r(t)})(t,e),children:[(0,v.jsx)("span",{className:"sp-text-sm sp-font-bold sp-block sp-pb-0.5",children:n}),(0,v.jsx)("span",{className:"sp-text-sm",children:l})]},e)}))})})),N=()=>{const{nonce:e}=stellarPayProductEditPage;return e},O=(0,w.compose)([(0,r.withSelect)((e=>{const{getProductType:t}=e(s);return{productType:t()}}))])((e=>{const{productType:t,readOnly:r,className:s}=e;return(0,v.jsxs)("span",{className:T("stellarpay-data",s),children:[(0,v.jsx)("input",{type:"hidden",name:"stellarpay[productType]",value:t,readOnly:r}),(0,v.jsx)("input",{type:"hidden",name:"stellarpay-nonce",value:N(),readOnly:r})]})}));function C(){const e=document.querySelector("#variable_product_options .woocommerce_variations"),t=document.querySelector("#variable_product_options .woocommerce_variations .stellarpay-data");if(t&&t.remove(),e){const t=document.querySelector("#variable_product_options .stellarpay-app-container .stellarpay-data");if(t){const r=t.cloneNode(!0);e.appendChild(r)}}}const q=(0,w.compose)([(0,r.withSelect)((e=>{const{getProductType:t}=e(s);return{productType:t()}}))])((e=>{const{productType:t,readOnly:r}=e;return(0,b.useEffect)((()=>{const e=document.querySelector('.woocommerce_variations .stellarpay-data input[name="stellarpay[productType]"]');e&&(e.value=t,e.parentElement.classList.add("variation-needs-update"),jQuery(e).trigger("change"),document.querySelectorAll(".woocommerce_variations .woocommerce_variation").forEach((e=>{e.classList.add("variation-needs-update")})))}),[t]),(0,b.useEffect)((()=>{const e=jQuery("#woocommerce-product-data");return e.on("woocommerce_variations_loaded",C),()=>{e.off("woocommerce_variations_loaded",C)}}),[]),(0,b.useEffect)((()=>{const e=e=>{if(e.target.matches('[name^="stellarpay"]')){const e=document.querySelector('.woocommerce_variations .stellarpay-data input[name="stellarpay[productType]"]');e&&e.parentElement.classList.add("variation-needs-update")}};return document.body.addEventListener("change",e),()=>{document.body.removeEventListener("change",e)}})),(0,v.jsx)(O,{readOnly:r})})),L=(0,w.compose)([(0,r.withSelect)((e=>{const{getWooProductType:t}=e(s);return{selectedWooProductType:t()}}))])((e=>{const{children:t,selectedWooProductType:r,wooProductType:s}=e;return(0,v.jsxs)("div",{className:"sp-mt-4 sp-ml-2",children:[t,j===s&&(0,v.jsx)(O,{readOnly:j!==r}),P===s&&(0,v.jsx)(q,{readOnly:P!==r})]})})),F={day:(0,a.__)("Daily","stellarpay"),week:(0,a.__)("Weekly","stellarpay"),month:(0,a.__)("Monthly","stellarpay"),year:(0,a.__)("Yearly","stellarpay"),custom:(0,a.__)("Custom","stellarpay")},$=e=>{const{title:t,description:r,children:s}=e;return(0,v.jsxs)("div",{className:"sp-pb-5",children:[(0,v.jsx)("span",{className:"sp-text-sm sp-font-semibold sp-text-slate-700 sp-block sp-pb-1",children:t}),r&&(0,v.jsx)("div",{className:"sp-pb-2.5 sp-text-sm sp-leading-6 sp-text-gray-600",children:r}),s]})},k=e=>{const{settingGroup:t,billingPeriod:r,recurringFrequency:s,recurringPeriod:o}=e,[n,l]=(0,b.useState)(r),[c,i]=(0,b.useState)(!1),[p,d]=(0,b.useState)(s||2),u=(0,b.useRef)(null),[m,y]=(0,b.useState)(!0);(0,b.useEffect)((()=>{"custom"===n&&c&&u.current.focus()}),[n,c]);const g=(_=p,{day:(0,a._n)("day","days",_,"stellarpay"),week:(0,a._n)("week","weeks",_,"stellarpay"),month:(0,a._n)("month","months",_,"stellarpay"),year:(0,a._n)("year","years",_,"stellarpay")});var _;return(0,v.jsxs)($,{title:(0,a.__)("Billing period","stellarpay"),description:(0,a.__)("This is how often the amount will be charged to customers.","stellarpay"),children:[(0,v.jsxs)("div",{className:"sp-border sp-border-solid sp-border-gray-300 sp-rounded sp-w-1/2",children:[(0,v.jsx)("select",{name:`stellarpay[${t}][billingPeriod]`,className:"sp-w-full sp-border-0",onChange:e=>{l(e.target.value),i(!0)},defaultValue:n,children:Object.keys(F).map((e=>(0,v.jsx)("option",{value:e,children:F[e]},e)))}),(0,v.jsx)("div",{className:"sp-clear-both"})]}),"custom"===n&&(0,v.jsxs)("div",{className:"sp-flex sp-items-center sp-w-fit sp-border sp-border-solid sp-border-gray-300 sp-rounded sp-mt-4",children:[(0,v.jsx)("div",{className:"sp-px-3 sp-text-sm",children:(0,a.__)("Every","stellarpay")}),(0,v.jsx)("div",{className:"sp-px-0 sp-border-0 sp-border-l sp-border-solid sp-border-gray-300",children:(0,v.jsx)("input",{name:`stellarpay[${t}][recurringFrequency]`,ref:u,type:"number",className:"sp-w-16 sp-border-0 sp-rounded-none sp-z-50",placeholder:"2",min:"2",max:"9999",onChange:e=>{if(""===e.target.value)return void y(!0);const t=parseInt(e.target.value);d(Number.isNaN(t)?2:t),y(t>1&&Number.isInteger(t))},defaultValue:p,onBlur:e=>{const t=parseInt(e.target.value);(t<=1||Number.isNaN(t))&&(e.target.value="2",d(2),y(!0))},autoComplete:"off"})}),(0,v.jsx)("div",{className:"sp-border-0 sp-border-l sp-border-solid sp-border-gray-300",children:(0,v.jsx)("select",{name:`stellarpay[${t}][recurringPeriod]`,className:"sp-border-0 sp-rounded-none sp-rounded-tr sp-rounded-br",defaultValue:o,children:Object.keys(g).map((e=>(0,v.jsx)("option",{value:e,children:g[e]},e)))})})]}),!m&&(0,v.jsx)("div",{className:"sp-mt-2 sp-text-red-500",children:(0,a.__)("Please enter 2 or more periods.","stellarpay")})]})},R=(e,t)=>{const r=e.trim();return!(r.replace(new RegExp(`[\\d${t.decimalSeparator}]`,"g"),"").length>0)&&new RegExp(`^(\\d+(${t.decimalSeparator}\\d*)?|${t.decimalSeparator}\\d+)$`).test(r)},A=(e,t)=>e.replace(new RegExp(`[^\\d${t.decimalSeparator}]`,"g"),"").replace(t.decimalSeparator,"."),I=(0,w.compose)([(0,r.withSelect)((e=>{const{getConfig:t}=e(s);return{...t()}}))])((e=>{const{id:t,settingGroup:r,value:s,decimalSeparator:a,decodedCurrencySymbol:o,label:n,description:l,onChange:c=()=>{},children:i}=e,[p,d]=(0,b.useState)(s),[u,m]=(0,b.useState)(null);return(0,v.jsxs)($,{title:n,description:l,children:[(0,v.jsxs)("div",{className:"sp-flex sp-w-1/2 sp-items-center sp-border sp-border-solid sp-border-gray-300 sp-rounded",children:[(0,v.jsx)("div",{className:"sp-pl-2 sp-z-10",children:o}),(0,v.jsx)("input",{name:`stellarpay[${r}][${t}]`,type:"text",placeholder:`0${a}00`,className:"sp-pl-2 sp-border-0 sp-w-full",onChange:e=>{if(m(null),""===e.target.value)return void d("");const t=R(e.target.value,{decimalSeparator:a});if(t){const t=A(e.target.value,{decimalSeparator:a});d(t)}c({event:e,isValid:t,setError:m})},defaultValue:p,autoComplete:"off"}),(0,v.jsx)("input",{type:"hidden",name:`stellarpay[${r}][${t}]`,value:u?"":p})]}),u&&(0,v.jsx)("div",{className:"sp-mt-2 sp-text-red-500",children:u}),i]})})),D=e=>{const{settingGroup:t,value:o}=e;return(0,v.jsx)(I,{id:"amount",label:(0,a.__)("Amount","stellarpay"),description:(0,a.__)("This is the amount that customers pay at regular intervals.","stellarpay"),settingGroup:t,value:o,onChange:({isValid:e,setError:t})=>{e||t((0,r.select)(s).getConfig().errorMessages.invalidAmount)}})},G=window.wp.components,Q=({date:e,onChange:t=()=>{},name:r,label:s,placeholder:o=(0,a.__)("YYYY-MM-DD","stellarpay"),wrapperClassName:n="",inputFieldClassName:l=""})=>{const[c,i]=(0,b.useState)(!1),[p,d]=(0,b.useState)(e),u=(e=>{if(!e)return"";const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`})(p);return(0,v.jsxs)("div",{className:n,children:[s&&(0,v.jsx)("div",{className:"sp-mb-1",children:s}),(0,v.jsxs)("div",{children:[(0,v.jsx)("input",{className:l,type:"text",value:u,placeholder:o,onClick:e=>{e.preventDefault(),i(!0)},readOnly:!0}),(0,v.jsx)("input",{type:"hidden",name:r,value:u})]}),c&&(0,v.jsx)(G.Popover,{onClose:()=>{i(!1)},placement:"bottom-start",offset:4,focusOnMount:"firstElement",expandOnMobile:!0,className:"sp-border sp-border-gray-200 sp-rounded",children:(0,v.jsx)("div",{className:"sp-component__datepicker__p-10",children:(0,v.jsx)(G.DatePicker,{currentDate:p,onChange:e=>{t(e),d(e),i(!1)},dateOrder:"ymd",__nextRemoveHelpButton:!0,__nextRemoveResetButton:!0})})})]})},Y=(0,w.compose)([(0,r.withSelect)((e=>{const{getConfig:t,getOptions:r,getProductType:a}=e(s),o=a();return{...t(),settingGroup:o,...r()[o]}}))])((e=>{const{settingGroup:t,saleFromDate:r,saleToDate:s}=e,[o,n]=(0,b.useState)(!(!r&&!s)),l=e=>{e.preventDefault(),n(!o)},c="sp-mt-2 sp-bg-transparent sp-text-[#2271B1] underline sp-underline sp-border-0 sp-pl-0 sp-cursor-pointer";return o?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("button",{className:`sp-pb-5 ${c}`,onClick:l,children:(0,a.__)("Cancel schedule","stellarpay")}),(0,v.jsxs)("div",{className:"sp-flex sp-w-1/2 sp-gap-[4%]",children:[(0,v.jsx)("div",{className:"sp-w-[48%]",children:(0,v.jsx)($,{title:(0,a.__)("Sale start date","stellarpay"),children:(0,v.jsx)(Q,{date:r,name:`stellarpay[${t}][saleFromDate]`,placeholder:(0,a.__)("From... YYYY-MM-DD","stellarpay"),inputFieldClassName:"sp-border sp-border-gray-300 sp-rounded sp-w-full sp-cursor-pointer sp-bg-white"})})}),(0,v.jsx)("div",{className:"sp-w-[48%]",children:(0,v.jsx)($,{title:(0,a.__)("Sale end date","stellarpay"),children:(0,v.jsx)(Q,{date:s,name:`stellarpay[${t}][saleToDate]`,placeholder:(0,a.__)("To... YYYY-MM-DD","stellarpay"),inputFieldClassName:"sp-border sp-border-gray-300 sp-rounded sp-w-full sp-cursor-pointer sp-bg-white"})})})]})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("button",{className:c,onClick:l,children:(0,a.__)("Schedule","stellarpay")}),(0,v.jsx)("input",{type:"hidden",name:`stellarpay[${t}][saleFromDate]`,value:""}),(0,v.jsx)("input",{type:"hidden",name:`stellarpay[${t}][saleToDate]`,value:""})]})})),M=(0,w.compose)([(0,r.withSelect)((e=>{const{getConfig:t}=e(s);return{...t()}}))])((e=>{const{settingGroup:t,value:r,decimalSeparator:s,errorMessages:o}=e,{invalidAmount:n,saleAmountLessThanRegularAmount:l}=o;return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(I,{id:"saleAmount",label:(0,a.__)("Sale amount","stellarpay"),description:(0,a.__)("Set a discount amount that customers pay at regular intervals.","stellarpay"),settingGroup:t,value:r,onChange:({event:e,isValid:t,setError:r})=>{if(!t)return void r(n);const o=A(e.target.closest(".stellarpay-app-container").querySelector('[name*="[amount]"][type="hidden"]').value,{decimalSeparator:s});if(!o)return void r((0,a.__)("Regular amount must be set before entering a sale amount.","stellarpay"));const c=parseFloat(o),i=A(e.target.value,{decimalSeparator:s});parseFloat(i)>=c&&r(l)},children:(0,v.jsx)(Y,{})})})})),B=(0,w.compose)([(0,r.withSelect)((e=>{const{getSubscriptionPaymentOptions:t}=e(s);return{...t()}}))])((e=>{const{amount:t,saleAmount:r,billingPeriod:s,recurringFrequency:a,recurringPeriod:n}=e,l=o.subscriptionPayments.id;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(D,{settingGroup:l,value:t}),(0,v.jsx)(M,{settingGroup:l,value:r}),(0,v.jsx)(k,{settingGroup:l,billingPeriod:s,recurringFrequency:a,recurringPeriod:n})]})})),W=e=>{const{settingGroup:t,value:r}=e,[s,o]=(0,b.useState)(r||2),[n,l]=(0,b.useState)(!0);return(0,v.jsxs)($,{title:(0,a.__)("Number of installments","stellarpay"),description:(0,a.__)("This is the number of times the customer will be charged the amount above.","stellarpay"),children:[(0,v.jsxs)("div",{className:"sp-flex sp-items-center sp-w-fit sp-border sp-border-solid sp-border-gray-300 sp-rounded",children:[(0,v.jsx)("div",{className:"sp-p-0 sp-border-0 sp-border-r sp-border-solid sp-border-gray-300",children:(0,v.jsx)("input",{name:`stellarpay[${t}][numberOfPayments]`,type:"number",className:"sp-w-16 sp-border-0",placeholder:"2",min:"2",max:"9999",onChange:e=>{if(""===e.target.value)return void l(!0);const t=parseInt(e.target.value);o(Number.isNaN(t)?2:t),l(t>1&&Number.isInteger(t))},onBlur:e=>{const t=parseInt(e.target.value);(t<=1||Number.isNaN(t))&&(e.target.value="2",o(2),l(!0))},defaultValue:s,autoComplete:"off"})}),(0,v.jsx)("div",{className:"sp-px-3",children:(0,a._n)("Payment","Payments",s,"stellarpay")})]}),!n&&(0,v.jsx)("div",{className:"sp-mt-2 sp-text-red-500",children:(0,a.__)("Please enter 2 or more installments.","stellarpay")})]})},V=(0,w.compose)([(0,r.withSelect)((e=>{const{getInstallmentPaymentOptions:t}=e(s);return{...t()}}))])((e=>{const{amount:t,saleAmount:r,billingPeriod:s,recurringFrequency:a,recurringPeriod:n,numberOfPayments:l}=e,c=o.installmentPayments.id;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(D,{settingGroup:c,value:t}),(0,v.jsx)(M,{settingGroup:c,value:r}),(0,v.jsx)(k,{settingGroup:c,billingPeriod:s,recurringFrequency:a,recurringPeriod:n}),(0,v.jsx)(W,{settingGroup:c,value:l})]})})),H=e=>{const{children:t,bottomSeparator:r=!0}=e;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"sp-ml-2 sp-mt-4",children:t}),r&&(0,v.jsx)("div",{className:"sp-border-0 sp-mb-8 sp-border-b sp-border-solid sp-border-gray-300"})]})},z=(0,w.compose)([(0,r.withSelect)((e=>{const{getProductType:t,getWooProductType:r}=e(s);return{productType:t(),wooProductType:r()}}))])((e=>{const{productType:t,wooProductType:r}=e,{subscriptionPayments:s,installmentPayments:a}=o;return(({wooProductType:e,productType:t})=>{(0,b.useEffect)((()=>{const e=document.querySelector("#general_product_data ._regular_price_field").parentElement;return o.onetimePayments.id!==t&&e.classList.add("sp-absolute","-sp-left-full"),()=>{e.classList.remove("sp-absolute","-sp-left-full")}}),[e,t]),(0,b.useEffect)((()=>{const t=document.querySelector("#general_product_data .stellarpay-app-container");t&&(t.style.display=j!==e?"none":"block")}),[e])})({wooProductType:r,productType:t}),(0,v.jsxs)(L,{wooProductType:j,children:[(0,v.jsx)(E,{}),s.id===t&&(0,v.jsx)(H,{children:(0,v.jsx)(B,{})}),a.id===t&&(0,v.jsx)(H,{children:(0,v.jsx)(V,{})})]})}));x("general_product_data",(0,v.jsx)(z,{}));const U=(0,w.compose)([(0,r.withSelect)((e=>{const{getProductType:t,getWooProductType:r}=e(s);return{productType:t(),wooProductType:r()}}))])((e=>{const{wooProductType:t,productType:n}=e;return(e=>{const{wooProductType:t,productType:r}=e;(0,b.useEffect)((()=>{const e=jQuery("#woocommerce-product-data"),t=c(),s=()=>{if(!c())return;var e;l(o.onetimePayments.id===r?"remove":"add"),e=r,Object.values(o).forEach((t=>{const r=document.querySelector("#variable_product_options .woocommerce_variations"),s=`.stellarpay_${t.id}`,a=r.querySelectorAll(s);a&&a.forEach((r=>{t.id===e?r.style.removeProperty("display"):r.style.display="none"}))}));const t=document.querySelectorAll("#variable_product_options .stellarpay-sale-date-fields div.js-sale-date-field-container");t.length&&t.forEach((e=>{if(!e.isReactRendered){const t=e.dataset.selecteddate,r=e.dataset.fieldname,s=e.dataset.placeholder;(0,b.createRoot)(e).render((0,v.jsx)(Q,{wrapperClassName:"sp-mb-4",inputFieldClassName:"sp-border sp-border-[#8c8f94] sp-rounded sp-w-full sp-cursor-pointer sp-bg-white",date:t,name:r,placeholder:s,onChange:()=>{const t=e.closest(".stellarpay-sale-date-fields").previousElementSibling.querySelector('input[name*="[saleAmount]"]');jQuery(t).trigger("change"),i()}})),e.isReactRendered=!0}}))};return e.on("woocommerce_variations_loaded",s),e.on("woocommerce_variations_added",s),t&&s(),()=>{l("remove"),e.off("woocommerce_variations_loaded",s),e.off("woocommerce_variations_added",s)}}),[t,r]),(0,b.useEffect)((()=>{const e=jQuery("#woocommerce-product-data"),r=()=>{const e=document.querySelector("#variable_product_options .stellarpay-app-container");P===t&&c()?e.style.display="block":e.style.display="none"};return r(),e.on("woocommerce_variations_loaded",r),e.on("woocommerce_variations_added",r),()=>{e.off("woocommerce_variations_loaded",r),e.off("woocommerce_variations_added",r)}}),[t]),(0,b.useEffect)((()=>{const e=document.querySelector("#variable_product_options"),t=e=>{if(e.target.matches(".js-sale-date-fields-switcher")){e.preventDefault();const t=e.target.closest(`.stellarpay_${r}`).querySelector(".stellarpay-sale-date-fields");if("none"===t.style.display)e.target.textContent=(0,a.__)("Cancel schedule","stellarpay"),t.style.display="block";else{e.target.textContent=(0,a.__)("Schedule","stellarpay"),t.style.display="none";const s=e.target.closest(".form-field"),o=s.querySelector('input[name*="[saleAmount]"]');jQuery(o).trigger("change"),s.closest(`.stellarpay_${r}`).querySelector(".stellarpay-sale-date-fields").querySelectorAll("input").forEach((e=>{e.value=""}))}i()}};return e.addEventListener("click",t),()=>{e.removeEventListener("click",t)}}))})({wooProductType:t,productType:n}),function(){const{getConfig:e}=(0,r.select)(s),{decimalSeparator:t}={...e()};(0,b.useEffect)((()=>{const e=e=>{const t=e.target;if(!t.closest(".woocommerce_variation.wc-metabox"))return;const r=t.closest("div.form-row")?.querySelector(".js-stellarpay-recurring-billing-period-form-fields");if(!r)return;const s="custom"===t.value;r.style.display=s?"":"none"};return document.addEventListener("change",e),()=>{document.removeEventListener("change",e)}})),(0,b.useEffect)((()=>{const e=e=>{const t=e.target;let r;switch(!0){case t.classList.contains("js-stellarpay-recurring-frequency-form-field"):r="i18n_stellarpay_recurring_frequency_error";break;case t.classList.contains("js-stellarpay-number-of-payments-form-field"):r="i18n_stellarpay_number_of_payments_error";break;default:return}t.value<2?jQuery(document.body).triggerHandler("wc_add_error_tip",[jQuery(t),r]):jQuery(document.body).triggerHandler("wc_remove_error_tip",[jQuery(t),r])};return document.addEventListener("input",e),()=>{document.removeEventListener("input",e)}})),(0,b.useEffect)((()=>{const e=e=>{const r=e.target;if(!r.classList.contains("js-stellarpay-sales-amount-form-field"))return;const s=r.closest(".stellarpay-price-fields")?.querySelector(".js-stellarpay-regular-amount-form-field");if(!s)return;const a="i18n_stellarpay_sales_amount_error";parseFloat(A(s.value,{decimalSeparator:t}))<=parseFloat(A(r.value,{decimalSeparator:t}))?jQuery(document.body).triggerHandler("wc_add_error_tip",[jQuery(r),a]):jQuery(document.body).triggerHandler("wc_remove_error_tip",[jQuery(r),a])};return document.addEventListener("input",e),()=>{document.removeEventListener("input",e)}})),(0,b.useEffect)((()=>{const e=e=>{const r=e.target;r.name.includes("stellarpay")&&r.getAttribute("data-input")&&(document.getElementById(r.getAttribute("data-input")).value=A(r.value,{decimalSeparator:t}))};return document.addEventListener("input",e),()=>{document.removeEventListener("input",e)}}))}(),(0,v.jsx)(L,{wooProductType:P,children:(0,v.jsx)(E,{})})}));woocommerce_admin.i18n_stellarpay_recurring_frequency_error=stellarPayProductEditPage.i18n.recurringFrequencyError,woocommerce_admin.i18n_stellarpay_number_of_payments_error=stellarPayProductEditPage.i18n.numberOfPaymentsError,woocommerce_admin.i18n_stellarpay_sales_amount_error=stellarPayProductEditPage.i18n.regularAmountLessThanSalesAmountError,x("variable_product_options",(0,v.jsx)(U,{})),jQuery("#variable_product_options").on("reload",(()=>{x("variable_product_options",(0,v.jsx)(U,{}))})),function(){const{setWooProductType:e}=(0,r.dispatch)(s);document.getElementById("product-type").addEventListener("change",(t=>{e(t.target.value)}))}()})();